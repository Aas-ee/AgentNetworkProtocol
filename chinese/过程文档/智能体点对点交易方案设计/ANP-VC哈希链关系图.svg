<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg width="900" height="500" xmlns="http://www.w3.org/2000/svg">
    <!-- 样式定义 -->
    <defs>
        <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
            <polygon points="0 0, 10 3.5, 0 7" fill="#333"/>
        </marker>
        <filter id="shadow" x="-10%" y="-10%" width="120%" height="130%">
            <feDropShadow dx="2" dy="2" stdDeviation="2" flood-color="#0002"/>
        </filter>
    </defs>
    
    <!-- 背景 -->
    <rect width="900" height="500" fill="white"/>
    
    <!-- 标题 -->
    <text x="450" y="30" font-family="Arial, sans-serif" font-size="24" text-anchor="middle" font-weight="bold">ANP协议 - 理想状态下的VC哈希链关系</text>
    
    <!-- VC盒子 - 酒店智能体颜色 -->
    <rect x="50" y="80" width="200" height="80" rx="10" ry="10" fill="white" stroke="#1976d2" stroke-width="2" filter="url(#shadow)"/>
    <text x="150" y="110" font-family="Arial, sans-serif" font-size="16" text-anchor="middle" font-weight="bold">订单提议凭证</text>
    <text x="150" y="135" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">OrderOfferCredential</text>
    <text x="150" y="150" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#1976d2">发行方: 酒店智能体</text>
    
    <!-- VC盒子 - 用户智能体颜色 -->
    <rect x="350" y="80" width="200" height="80" rx="10" ry="10" fill="white" stroke="#388e3c" stroke-width="2" filter="url(#shadow)"/>
    <text x="450" y="110" font-family="Arial, sans-serif" font-size="16" text-anchor="middle" font-weight="bold">预订确认凭证</text>
    <text x="450" y="135" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">BookingConfirmationCredential</text>
    <text x="450" y="150" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#388e3c">发行方: 用户智能体</text>
    
    <!-- VC盒子 - 酒店智能体颜色 -->
    <rect x="650" y="80" width="200" height="80" rx="10" ry="10" fill="white" stroke="#1976d2" stroke-width="2" filter="url(#shadow)"/>
    <text x="750" y="110" font-family="Arial, sans-serif" font-size="16" text-anchor="middle" font-weight="bold">支付请求凭证</text>
    <text x="750" y="135" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">PaymentRequestCredential</text>
    <text x="750" y="150" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#1976d2">发行方: 酒店智能体</text>
    
    <!-- VC盒子 - 支付智能体颜色 -->
    <rect x="650" y="200" width="200" height="80" rx="10" ry="10" fill="white" stroke="#f57c00" stroke-width="2" filter="url(#shadow)"/>
    <text x="750" y="230" font-family="Arial, sans-serif" font-size="16" text-anchor="middle" font-weight="bold">支付指令凭证</text>
    <text x="750" y="255" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">PaymentInstructionCredential</text>
    <text x="750" y="270" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#f57c00">发行方: 支付智能体</text>
    
    <!-- VC盒子 - 支付智能体颜色 -->
    <rect x="350" y="200" width="200" height="80" rx="10" ry="10" fill="white" stroke="#f57c00" stroke-width="2" filter="url(#shadow)"/>
    <text x="450" y="230" font-family="Arial, sans-serif" font-size="16" text-anchor="middle" font-weight="bold">资金托管凭证</text>
    <text x="450" y="255" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">FundsEscrowedCredential</text>
    <text x="450" y="270" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#f57c00">发行方: 支付智能体</text>
    
    <!-- VC盒子 - 酒店智能体颜色 (可选) -->
    <rect x="50" y="200" width="200" height="80" rx="10" ry="10" fill="white" stroke="#1976d2" stroke-width="2" stroke-dasharray="5,5" filter="url(#shadow)"/>
    <text x="150" y="225" font-family="Arial, sans-serif" font-size="14" text-anchor="middle" font-weight="bold">预订完成凭证</text>
    <text x="150" y="245" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">(可选)</text>
    <text x="150" y="265" font-family="Arial, sans-serif" font-size="11" text-anchor="middle">BookingFinalizedCredential</text>
    <text x="150" y="280" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#1976d2">发行方: 酒店智能体</text>
    
    <!-- VC盒子 - 用户智能体颜色 -->
    <rect x="350" y="320" width="200" height="90" rx="10" ry="10" fill="white" stroke="#388e3c" stroke-width="2" filter="url(#shadow)"/>
    <text x="450" y="350" font-family="Arial, sans-serif" font-size="16" text-anchor="middle" font-weight="bold">服务完成确认凭证</text>
    <text x="450" y="375" font-family="Arial, sans-serif" font-size="11" text-anchor="middle">ServiceCompletionConfirmation</text>
    <text x="450" y="395" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#388e3c">发行方: 用户智能体</text>
    
    <!-- VC盒子 - 支付智能体颜色 -->
    <rect x="650" y="320" width="200" height="80" rx="10" ry="10" fill="white" stroke="#f57c00" stroke-width="2" filter="url(#shadow)"/>
    <text x="750" y="350" font-family="Arial, sans-serif" font-size="16" text-anchor="middle" font-weight="bold">资金释放凭证</text>
    <text x="750" y="375" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">FundsReleasedCredential</text>
    <text x="750" y="390" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#f57c00">发行方: 支付智能体</text>
    
    <!-- 哈希链接 -->
    <line x1="250" y1="120" x2="350" y2="120" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
    <line x1="550" y1="120" x2="650" y2="120" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
    <line x1="750" y1="160" x2="750" y2="200" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
    <line x1="650" y1="240" x2="550" y2="240" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
    <path d="M350 240 C300 240, 280 240, 250 240" stroke="#333" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrowhead)"/>
    <path d="M450 280 L450 320" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
    <line x1="150" y1="280" x2="350" y2="360" stroke="#333" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrowhead)"/>
    <line x1="550" y1="360" x2="650" y2="360" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
    
    <!-- 哈希链接文本 -->
    <text x="300" y="110" font-family="Arial, sans-serif" font-size="10" text-anchor="middle">包含哈希</text>
    <text x="600" y="110" font-family="Arial, sans-serif" font-size="10" text-anchor="middle">包含哈希</text>
    <text x="770" y="180" font-family="Arial, sans-serif" font-size="10" text-anchor="middle">包含哈希</text>
    <text x="600" y="230" font-family="Arial, sans-serif" font-size="10" text-anchor="middle">包含哈希</text>
    <text x="300" y="230" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#666">包含哈希(可选)</text>
    <text x="470" y="300" font-family="Arial, sans-serif" font-size="10" text-anchor="middle">包含哈希</text>
    <text x="230" y="340" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#666">包含哈希(可选路径)</text>
    <text x="600" y="350" font-family="Arial, sans-serif" font-size="10" text-anchor="middle">包含哈希</text>
    
    <!-- 图例 -->
    <rect x="80" y="430" width="20" height="15" fill="white" stroke="#1976d2" stroke-width="1"/>
    <text x="105" y="442" font-family="Arial, sans-serif" font-size="12" fill="#1976d2">酒店智能体发行</text>
    
    <rect x="240" y="430" width="20" height="15" fill="white" stroke="#388e3c" stroke-width="1"/>
    <text x="265" y="442" font-family="Arial, sans-serif" font-size="12" fill="#388e3c">用户智能体发行</text>
    
    <rect x="400" y="430" width="20" height="15" fill="white" stroke="#f57c00" stroke-width="1"/>
    <text x="425" y="442" font-family="Arial, sans-serif" font-size="12" fill="#f57c00">支付智能体发行</text>
    
    <!-- 箭头图例 -->
    <g transform="translate(550, 440)">
        <line x1="0" y1="0" x2="30" y2="0" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
        <text x="50" y="5" font-family="Arial, sans-serif" font-size="12">必须哈希引用</text>
    </g>
    
    <g transform="translate(700, 440)">
        <line x1="0" y1="0" x2="30" y2="0" stroke="#333" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrowhead)"/>
        <text x="50" y="5" font-family="Arial, sans-serif" font-size="12">可选哈希引用</text>
    </g>
    
    <!-- 图表说明 -->
    <text x="450" y="480" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#555">
        图4: ANP协议中的VC哈希链 - 每个凭证通过包含前一个凭证的哈希值形成不可篡改的链式结构
    </text>
</svg>
