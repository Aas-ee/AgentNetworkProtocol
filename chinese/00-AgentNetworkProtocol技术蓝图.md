# Agent Network Protocol技术蓝图

## 愿景

在人工智能迅猛发展的新时代，我们正迈入智能体网络的崭新纪元。Agent Network Protocol (ANP) 将成为这一时代的核心技术，为数十亿智能体构建一个开放、安全、高效的协作网络。

想象未来：你的个人助理AI在为你订餐时，与餐厅的智能系统无缝沟通；你的智能家居系统与能源管理AI协同优化用电；你的投资顾问AI与全球市场分析智能体实时交换信息......这就是即将到来的智能体网络时代。

Agent Network Protocol(ANP)的愿景是定义智能体网络时代的连接方式，就像互联网协议成就了信息时代。我们相信，在不远的将来，数十亿智能体将通过ANP构建起前所未有的协作网络，创造出比现有互联网更大的价值。在ANP加持下，智能体网络最终会演化成一个自组织、自协商的高效协作网络，这是一个令人兴奋的未来。

## 协议分层

Agent Network Protocol(ANP)整体上设计为三层架构，从下到上依次是身份与加密通信层、元协议层、应用协议层，如下图所示：

![协议分层图](/images/protocol-layer-design.png)

### 身份与加密通信层

这是整个协议最基础的部分，主要解决智能体通信的两大挑战：智能体之间如何进行身份认证，以及如何进行端到端加密通信。

基于W3C DID（Decentralized Identifiers，去中心化标识符）规范，融合区块链技术与端到端加密技术，Agent Network Protocol(ANP)提供了一个突破性的解决方案：

- **完全去中心化**：智能体可完全掌控自己的身份标识，而不用受限于任何平台
- **无障碍连接**：支持任意平台间的智能体身份认证，打破平台之间的鸿沟
- **极致安全**：端到端加密确保通信安全，中间节点无法破解内容
- **低成本高效**：基于现有Web基础设施，快速部署，成本极低

W3C DID 是Agent Network Protocol(ANP)的身份和加密通信层的核心基石，它的去中心化、互操作性等特性成就了ANP协议的开发性，让任意两个智能体都能够通过它建立连接，让我们能够构建一个开放的智能体协作网络。

详细技术文档：[GitHub](https://github.com/chgaowei/AgentNetworkProtocol)

### 元协议层

在元协议加持下，智能体网络有可能会演进成一个自组织、自协商的高效协作网络，这是一个令人兴奋的未来。

所谓的元协议，即协商通信使用协议的协议。在元协议层，我们主要参考和借鉴的是[Agora Protocol](https://arxiv.org/html/2410.11905v1)。

当前的数字世界，存在着巨大的数据孤岛现象，数据的流动集中在孤岛内部，而孤岛和孤岛之间则只有少量数据流动。这一结果的出现，除了商业上的原因，技术限制也是一个很大的原因：异构网络（不同架构、功能、设计）通过协议互通往往要付出巨大的成本，这里面的根本原因在于Agora Protocol论文中提出的异构网络通信的不可能三角（Versatility（多功能性）、Efficiency（效率）、Portability（可移植性））。

LLM加持的智能体结合元协议是解决这一问题的良方：

- 智能体之间首先使用自然语言，互相沟通各自的能力、数据交换格式、使用的协议等，确定智能体之间通信的协议细节。
- 根据协商结果，智能体使用LLM构造和处理协议消息，或者使用智能体生成处理协议的代码，来构造和处理协议消息。
- 智能体之间进行协议联调，使用LLM判断协议消息是否符合协商规范，如果不符合，则通过自然语言交互进行解决。
- 最后，智能体使用最终的协议进行通信。

我们相信，在LLM的自然语言理解能力和代码生成能力，以及元协议技术的推动下，智能体网络最终会演进成一个自组织、自协商的高效协作网络，并且会诞生非常多智能体之间达成共识的通信协议，这些协议的数量将会大大超过人类制定协议的数量。

### 应用协议层

应用层协议分为两类，一类是行业当前已经存在的规范，比如email协议、RTC相关规范、W3C现有规范等，一类是智能体网络自动协商出来共识协议。他们的目标都是为了智能体能够一起协作完成某个业务。

在协议传递数据的类型上，大概可以分为三类：文本、文件、多媒体实时数据流。这三种类型基本可以覆盖当前所有的业务类型。

智能体之间在基础协议之上，根据自己的数据或业务特点，自有的对协议进行扩展。标准规范在智能体网络中的作用，主要是降低协商的复杂度，而非强制规范，我们相信智能体两两之间能够协商出最适合他们业务场景的个性化协议。

## AgentConnect：Agent Network Protocol(ANP)的开源实现

我们开源了一个项目，AgentConnect（https://github.com/chgaowei/AgentConnect），用来实现Agent Network Protocol(ANP)的功能，项目架构如下图：

![项目架构图](/images/agent-connect-architecture.png)

对应Agent Network Protocol的三层架构，AgentConnect主要包括以下几个部分：

1. **身份认证模块与端到端加密模块**
   主要实现基于W3C DID的身份认证和端到端加密通信，包括DID文档的生成、校验、获取，以及基于DID和ECDHE(Elliptic Curve Diffie-Hellman Ephemeral，椭圆曲线迪菲-赫尔曼临时密钥交换)端到端加密通信方案实现。

2. **元协议模块**
   元协议模块需要基于LLM（大语言模型）和元协议实现，主要功能包含基于元协议的应用协议协商、协议代码实现、协议联调、协议处理等。

3. **应用层协议集成框架**
   主要的目的是管理和其他智能体通信的协议规范文档以及协议代码，包括应用协议加载、应用协议卸载、应用协议配置、应用协议处理。使用这个框架，智能体可以方便的、按需加载运行所需要的现成协议，加快智能体协议协商过程。

除了以上的功能之外，AgentConnect未来也会在性能、多平台支持等特性上发力：

- **性能**：作为一个基础的代码库，我们希望能够提供极致的性能，未来会用Rust来重写核心部分代码。
- **多平台**：现在支持mac、Linux、windows，未来将会支持移动端、浏览器。

## 里程碑

无论是协议还是开源代码实现，我们整体式是按照以下的顺序逐步的推进：

- 构建身份认证与端到端加密通信协议与实现。这是我们整个项目的基础与核心，当前协议设计和代码基本完成。
- 元协议设计与元协议代码实现。这将有助于智能体网络演进为一个自组织、自协商的高效协作网络，是我们当下正在做的事情，这将是一个令人兴奋的功能，预计不久之后我们就会发布第一个版本。
- 应用层协议集成框架开发。这将有助于Agent Network Protocol(ANP)在各种场景中为智能体提供服务。

除此之外，我们还会遵循先整体，后细节的原则。早期我们会致力于整体架构的搭建，为每一个主要的模块构建一个整体的轮廓，让它快速的运行起来，而不是构建一个个精美但无法运行的模块。

最后，在设计方案的过程中，我们逐渐的感受到，也许区块链是更适合智能体的网络基础设施，未来我们可能会在这个方向做一些积极的尝试和探索。

## 为什么选择Agent Network Protocol(ANP)？

- **开放互联**：基于 W3C DID 的去中心化身份认证，让智能体突破平台限制，实现自由安全的连接。
- **技术创新**：通过融合区块链与 DID 技术，首创性地解决了跨平台智能体认证的难题。
- **高效落地**：立足现有 Web 基础设施，实现低成本、快速部署，助力生态快速发展。
- **面向未来**：为智能体网络时代打造基础设施，驱动自组织协作网络的演进与创新。
- **专业团队**：由资深工程师和研究人员组成的核心团队，拥有丰富的分布式系统、协议设计和人工智能领域经验。
